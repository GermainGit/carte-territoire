
<div id="notice"><%= notice %></div>

  <div id="mapid">
    <div class="menu">
      <%= link_to image_tag('add.svg', alt: 'bouton ajouter nouvelle photo', id: 'add_img'), new_photo_path, id: 'btn_add_img' %>
    </div>

  </div>



<div class="container feed">
  <div class="row">
    <div class="card-columns">
<% @photos.each do |photo| %>

  <div class="card">
    <a href="photos/<%= photo.id %>">
    <img class="card-img-top" src="<%=  photo.file %>" alt="<%= photo.title %>">
    </a>
    <div class="card-body photo_content">
      <h5 class="card-title"><%= photo.title %></h5>
      <p class="card-text"><%= photo.content %></p>
    </div>
  </div>
    <% end %>
       </div>
  </div>
</div>

<br>
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
   integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
   crossorigin=""></script>

<script>
  var map = new L.Map('mapid').setView([44.84561111, -0.58027778], 6);

 L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.{ext}', {
    attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',
    maxZoom: 18,
    minZoom: 8,
    ext: 'png'
 }).addTo(map);
 map.attributionControl.setPrefix('');

var southWest = L.latLng(43.18155760646617, -0.90),
northEast = L.latLng(46.99346179538875, 0.3);
var bounds = L.latLngBounds(southWest, northEast);

map.setMaxBounds(bounds);
map.on('drag', function(){
  map.panInsideBounds(bounds, { animate: false});
});

 // Define an array. This could be done in a seperate js file.
 // This tidy formatted section could even be generated by a server-side script
 // or fetched seperately as a jsonp request.



<% @photos.each do |photo| %>
    var long = <%= photo.long %>;
    var lat = <%= photo.lat %>;
    var icon = L.icon({
      iconUrl: '<%= photo.file %>',
      iconSize: [45, 45],
      iconRadius: 25
    });
    var markerLocation = new L.LatLng(lat, long);
    var marker = new L.Marker(markerLocation, {icon: icon});
    map.addLayer(marker);

    marker.on("click", function (event) {
    var clickedMarker = event.layer;
    document.location.href="photos/<%= photo.id %>";
});

<% end %>

</script>

